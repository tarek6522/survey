{% extends "base.html" %}
{% load static %}

{% block content %}
<div class="container mt-5">
  {% if request.user.is_superuser %}
    <h1>๐ ููุญุฉ ุชุญูู ุงูุฃุฏูู</h1>
    <hr>

    <div style="display: flex; gap: 20px; margin-bottom: 30px;">
      <div style="background: #f0f0f0; padding: 20px; border-radius: 10px;">
        <h3>๐ฅ ุนุฏุฏ ุงููุณุชุฎุฏููู</h3>
        <p><strong>{{ users|length }}</strong></p>
      </div>
      <div style="background: #f0f0f0; padding: 20px; border-radius: 10px;">
        <h3>๐ ุนุฏุฏ ุงูุงุณุชุจูุงูุงุช</h3>
        <p><strong>{{ surveys|length }}</strong></p>
      </div>
    </div>

    <div style="margin-bottom: 20px;">
      <a href="/admin/" class="btn btn-dark">โ๏ธ ููุญุฉ ุฅุฏุงุฑุฉ Django</a>
      <a href="/rewards/my-requests/" class="btn btn-success">๐ฑ ุทูุจุงุช ุงูููุงูุขุช</a>
      <a href="/surveys/" class="btn btn-primary">๐ ุนุฑุถ ุงูุงุณุชุจูุงูุงุช</a>
      <a href="/admin-dashboard/add-survey/" class="btn btn-outline-primary">โ ุฅูุดุงุก ุงุณุชุจูุงู</a>
    </div>

    <h2>๐ ุงููุดุงุฑููู</h2>
    <table border="1" cellpadding="5" cellspacing="0" style="width: 100%; margin-bottom: 40px;">
      <thead>
        <tr>
          <th>ุงูุงุณู</th>
          <th>ุงูุจุฑูุฏ</th>
          <th>ุงูููุงุท</th>
          <th>ุงููุฌููุนุฉ</th>
          <th>ุงูุชุญูู</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr>
          <td>{{ user.get_full_name }}</td>
          <td>{{ user.email }}</td>
          <td>{{ user.profile.points }}</td>
          <td>{{ user.profile.group }}</td>
          <td>
            <form method="post" action="/admin-dashboard/update-points/" style="display:inline-block;">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ user.id }}">
              <input type="number" name="points" value="{{ user.profile.points }}" style="width:60px">
              <button type="submit">๐พ</button>
            </form>
            <form method="post" action="/admin-dashboard/toggle-active/" style="display:inline-block;">
              {% csrf_token %}
              <input type="hidden" name="user_id" value="{{ user.id }}">
              <button type="submit">{% if user.is_active %}๐ซ ุชุนุทูู{% else %}โ ุชูุนูู{% endif %}</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <h2>๐ ุงูุงุณุชุจูุงูุงุช</h2>
    <table border="1" cellpadding="5" cellspacing="0" style="width: 100%;">
      <thead>
        <tr>
          <th>ุงูุนููุงู</th>
          <th>ุนุฏุฏ ุงูุฃุณุฆูุฉ</th>
          <th>ุงูููุงุท</th>
          <th>ุงูุญุงูุฉ</th>
          <th>ุงูุชุญูู</th>
        </tr>
      </thead>
      <tbody>
        {% for survey in surveys %}
        <tr>
          <td>{{ survey.title }}</td>
          <td>{{ survey.questions.count }}</td>
          <td>{{ survey.points }}</td>
          <td>{{ survey.is_active|yesno:"ููุนู,ูุนุทู" }}</td>
          <td>
            <a href="/admin/surveys/survey/{{ survey.id }}/change/">โ๏ธ ุชุนุฏูู</a>
            |
            <a href="/admin/surveys/survey/{{ survey.id }}/delete/" onclick="return confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุงูุญุฐูุ')">
              ๐๏ธ ุญุฐู
            </a>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

  {% else %}
    <div class="alert alert-danger">
      ๐ซ ููุณ ูุฏูู ุตูุงุญูุฉ ุงููุตูู ุฅูู ููุญุฉ ุชุญูู ุงูุฃุฏูู.
    </div>
  {% endif %}
</div>
{% endblock %}
